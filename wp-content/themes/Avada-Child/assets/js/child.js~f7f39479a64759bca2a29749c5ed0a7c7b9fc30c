(function ($) {
    $(document).ready(function () {

        // Mobile menu
        $('.fusion-flyout-menu-toggle').on('click', function (e) {
            e.preventDefault();
            $('.fusion-header').removeAttr('style');
            $('.fusion-flyout-mobile-menu-icons').toggleClass('change');

            $('.fusion-flyout-menu-bg').toggleClass('active-bg');
            $('.fusion-flyout-menu .fusion-menu').toggleClass('fly');
            $('.custom-caret').remove();

            if ($('.fusion-mobile-nav-holder li').hasClass('menu-item-has-children')) {
                    $('.fusion-flyout-menu .fusion-menu .menu-item-has-children a').append('<span class="fusion-caret custom-caret"><i class="fusion-dropdown-indicator" aria-hidden="true"></i></span>');
                    $('.fusion-flyout-menu .fusion-menu .menu-item-has-children a .custom-caret').on('click', function (e) {
                    e.preventDefault();

                    $(this).toggleClass('rotate');
                    $(this).closest('li').find('.sub-menu').toggleClass('open');

                });
            } else {
                // Leave empty
            }
        });

        // Legal menu
        $('.legal-content:first-child').addClass('active fadeInUp animated');
        $('.legal-menu li:first-child a').addClass('active');

        $('.legal-menu a').on('click', function (e) {

            if ( $(this).attr('target') == '_blank' ) {
                // Leave empty
            } else {
                e.preventDefault();
                $('.legal-menu a.active').removeClass('active');
                $(this).addClass('active');
                $('.legal-content').removeClass('active fadeInUp');

                var menu_id = $(this).attr('href');
                var hash = menu_id.split('#')[1];
                menu_id = $('#' + hash);

                menu_id.addClass('active fadeInUp animated');
            }
        });

        // Form submit
        $('.wpcf7-submit').on('click', function () {
            $('.contact-form').prepend('<div class="loading-spinner"><img src="/wp-content/themes/Avada-Child/assets/images/Spinner.gif"> </div>');
            setTimeout(function () {
                if ($('.wpcf7-acceptance-as-validation').hasClass('sent')) {
                    // $('.wpcf7-response-output.success').remove();
                    // $('.loading-spinner').hide();
                }

                if ($('.wpcf7-acceptance-as-validation').hasClass('invalid')) {
                    $('.loading-spinner').hide();
                }

            }, 5000);
        });

        // $('.fusion-flyout-menu').append('<div class="menu-cover-title">Menu</div>');
        // *********************************************************************************

        // Equal heights
        $.fn.equalHeights = function () {
            var max_height = 0;
            $(this).each(function () {
                max_height = Math.max($(this).height(), max_height);
            });
            $(this).each(function () {
                $(this).height(max_height);
            });
        };

        $('.equal-height').equalHeights();


        // News clicktrough
        $('.latest-news-item .card').on('click', function () {
            var url = $(this).find('a').attr('href');
            window.location = url;
        });


        // Animations

        var t = 0.2;
        $('.delay').each(function (i) {
            $(this).css('animation-delay', t + 's');
            t = t + 0.2;
        });

        // Animation Callup (always on bottom of this script !!!!)
        WOW.prototype.addBox = function (element) {
            this.boxes.push(element);
        };

        // Init WOW.js and get instance
        var wow = new WOW();
        wow.init();

        // Attach scrollSpy to .wow elements for detect view exit events,
        // then reset elements and add again for animation
        $('.wow').on('scrollSpy:exit', function () {
            $(this).css({
                'visibility': 'hidden',
                'animation-name': 'none'
            }).removeClass('animated');
            wow.addBox(this);
        }).scrollSpy();

        new WOW().init();

        // *********************************************************************************

    });

})(jQuery);